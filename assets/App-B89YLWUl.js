const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardPage-C0M8jXqd.js","assets/charts-nuwTBMFx.js","assets/react-DGBwUpAK.js","assets/api-DYJm7ZOt.js","assets/Sidebar-Bt-jCTJ7.js","assets/DeleteConfirmModal-IVzid9wc.js","assets/index-CZSJIl98.js","assets/index-DYigOwH5.css","assets/AdministrationPage-BAZl-jYe.js","assets/BrandFontsPage-BI40ZGtU.js","assets/BrandGuidelinesPage-BhgZi9DD.js","assets/BrandSlidesPage-CXejh-6b.js","assets/DocumentTemplatesPage-Dukprxsm.js","assets/HomePage-C1icBYPW.js","assets/LoginPage-CbGQ0pft.js","assets/WorkingMethodPage-CQGChQyM.js"])))=>i.map(i=>d[i]);
import{_ as k}from"./index-CZSJIl98.js";import{j as e}from"./charts-nuwTBMFx.js";import{u as le,d as me,r as s,L as N,N as fe,R as xe,c as x,e as F}from"./react-DGBwUpAK.js";import{f as je,a as ge,b as q,r as ke,c as ve,s as J,d as ee}from"./api-DYJm7ZOt.js";const nt=["Préparation","Passation","Restitution"],st=["Google Doc","Google Slide","Google Sheet","Google Form"],$={Préparation:"preparation",Passation:"passation",Restitution:"restitution"},ot=Object.fromEntries(Object.entries($).map(([t,a])=>[a,t]));let C={token:null,templates:null,inFlight:null};const W=new Set;function z(t){for(const a of W)a(t)}function be(){return typeof window>"u"?null:window.localStorage.getItem("authToken")}function _(){const t=be();return C.token!==t&&(C={token:t,templates:null,inFlight:null}),C}function te(){return _().templates}function at(t){const a=_();a.templates=t,z(t)}async function ie(){const t=_(),a=t.token;return t.templates?t.templates:(t.inFlight||(t.inFlight=je().then(r=>{const h=_();return h.token===a&&(h.templates=r,z(r)),r}).finally(()=>{const r=_();r.token===a&&(r.inFlight=null)})),t.inFlight)}function ne(){C={token:null,templates:null,inFlight:null},z(null)}function we(t){return W.add(t),()=>{W.delete(t)}}let E={token:null,projects:null,inFlight:null};const V=new Set;function H(t){for(const a of V)a(t)}function Le(){return typeof window>"u"?null:window.localStorage.getItem("authToken")}function S(){const t=Le();return E.token!==t&&(E={token:t,projects:null,inFlight:null}),E}function se(){return S().projects}function rt(t){const a=S();a.projects=t,H(t)}async function ce(){const t=S(),a=t.token;return t.projects?t.projects:(t.inFlight||(t.inFlight=ge().then(r=>{const h=S();return h.token===a&&(h.projects=r,H(r)),r}).finally(()=>{const r=S();r.token===a&&(r.inFlight=null)})),t.inFlight)}function oe(){E={token:null,projects:null,inFlight:null},H(null)}function ye(t){return V.add(t),()=>{V.delete(t)}}function Ne({state:t}){return t==="idle"?null:e.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[t==="syncing"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-[1.5px] border-primary-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-slate-400",children:"Synchronisation..."})]}),t==="saved"&&e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-success-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-slate-400",children:"Synchronisé"})]}),t==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-danger-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{className:"text-danger-500",children:"Erreur de sync"})]})]})}const _e=e.jsx("svg",{className:"h-[18px] w-[18px] shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.7,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-4 0a1 1 0 01-1-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 01-1 1h-2z"})}),Se=e.jsx("svg",{className:"h-[18px] w-[18px] shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.7,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),Pe=e.jsx("svg",{className:"h-[18px] w-[18px] shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.7,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),Te=e.jsx("svg",{className:"h-[18px] w-[18px] shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.7,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),Ce=e.jsx("svg",{className:"h-[18px] w-[18px] shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.7,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),Ee=e.jsxs("svg",{className:"h-[18px] w-[18px] shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.7,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.066 2.573c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.573 1.066c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.066-2.573c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),Ae=e.jsx("svg",{className:"h-[18px] w-[18px] shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.7,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),Me=[{to:"/modeles-documents/preparation",label:"Préparation",end:!0},{to:"/modeles-documents/passation",label:"Passation",end:!0},{to:"/modeles-documents/restitution",label:"Restitution",end:!0}],ae=[{to:"/",label:"Accueil",end:!0,icon:_e},{to:"/notre-facon-de-travailler",label:"Notre façon de travailler",icon:Se},{to:"/questionnaires",label:"Questionnaires UX",icon:Pe},{to:"/charte-graphique",label:"Charte graphique",icon:Te,children:[{to:"/charte-graphique/fonts",label:"Fonts"},{to:"/charte-graphique/slides",label:"Slides"},{to:"/charte-graphique",label:"Design system",end:!0}]},{to:"/modeles-documents",label:"Modèles de documents",icon:Ce,children:Me}],De={to:"/administration",label:"Administration",separatorBefore:!0,icon:Ee},B="__sans_dossier__";function I(t){return t.to==="/questionnaires"||!!t.children?.length}function Re(t,a){return a.find(r=>I(r)&&(t===r.to||t.startsWith(`${r.to}/`)))}function Fe(t){return t.to==="/charte-graphique"?"/charte-graphique/fonts":t.to==="/questionnaires"?"/questionnaires":t.to==="/modeles-documents"?"/modeles-documents/preparation":t.to}function qe({children:t,onLogout:a,fullBleed:r=!1,headerSyncState:h,canAccessAdministration:b=!1}){const l=le(),p=me(),j=s.useMemo(()=>b?[...ae,De]:ae,[b]),v=Re(l.pathname,j),[w,g]=s.useState(v?.to??null),o=se(),d=te(),[f,m]=s.useState(()=>o??[]),[G,P]=s.useState(!o),[U,ue]=s.useState(()=>d??[]),[de,Q]=s.useState(!d),[M,he]=s.useState(new Set),Y=n=>n.end?l.pathname===n.to:l.pathname===n.to||l.pathname.startsWith(`${n.to}/`),K=n=>{const[i,u]=n.to.split("#");return u?l.pathname===i&&l.hash===`#${u}`:n.end?l.pathname===i:l.pathname===i||l.pathname.startsWith(`${i}/`)};s.useEffect(()=>{g(v?.to??null)},[l.pathname,v?.to]),s.useEffect(()=>{let n=!0;const i=se();i?(m(i),P(!1)):P(!0);const u=ye(c=>{n&&(m(c??[]),P(!1))});return i||ce().catch(c=>{console.error("Load questionnaires list failed:",c),n&&P(!1)}),()=>{n=!1,u()}},[]),s.useEffect(()=>{let n=!0;const i=we(c=>{n&&(ue(c??[]),Q(!1))});return te()||ie().catch(c=>{console.error("Load document templates failed:",c),n&&Q(!1)}),()=>{n=!1,i()}},[]);const L=j.find(n=>n.to===w&&I(n)),X=!!L?.children||L?.to==="/questionnaires",D=n=>l.pathname==="/questionnaires"&&(l.hash===`#project/${n}`||l.hash.startsWith(`#project/${n}/`)),{folders:R,ungrouped:T}=s.useMemo(()=>{const n=new Map,i=[];for(const c of f){const y=c.folder?.trim();y?(n.has(y)||n.set(y,[]),n.get(y).push(c)):i.push(c)}return{folders:Array.from(n.entries()).sort(([c],[y])=>c.localeCompare(y,"fr")),ungrouped:i}},[f]),pe=s.useMemo(()=>{const n=new Map;for(const i of Object.values($))n.set(i,0);for(const i of U){const u=$[i.phase];n.set(u,(n.get(u)??0)+1)}return n},[U]),Z=n=>{he(i=>{const u=new Set(i);return u.has(n)?u.delete(n):u.add(n),u})};return e.jsxs("div",{className:"h-screen bg-cream text-ink flex flex-col",children:[e.jsx("header",{className:"w-full bg-cream",children:e.jsxs("div",{className:"flex w-full items-center justify-between px-6 py-4",children:[e.jsxs(N,{to:"/",className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-serif text-2xl leading-none text-ink md:text-3xl",children:"We Love Users"}),e.jsx("span",{className:"brand-chip",children:"TEAM"})]}),h&&e.jsx(Ne,{state:h})]})}),e.jsxs("div",{className:"min-h-0 flex flex-1",children:[e.jsx("aside",{className:"w-72 shrink-0 px-3 pb-3",children:e.jsxs("div",{className:"relative h-full overflow-hidden rounded-brand border border-stone bg-white shadow-sm flex flex-col",children:[e.jsxs("div",{className:`absolute inset-0 flex flex-col transition-transform duration-300 ease-out ${X?"-translate-x-full":"translate-x-0"}`,children:[e.jsx("nav",{className:"flex-1 overflow-y-auto px-3 py-4",children:e.jsx("ul",{className:"space-y-1",children:j.map(n=>e.jsx("li",{className:n.separatorBefore?"nav-item-separator":"",children:I(n)?e.jsxs("button",{type:"button","aria-expanded":w===n.to,onClick:()=>{g(n.to),p(Fe(n))},className:`nav-link nav-link-toggle cursor-pointer ${Y(n)?"active":""}`,children:[e.jsxs("span",{className:"flex items-center gap-2.5",children:[n.icon,e.jsx("span",{children:n.label})]}),e.jsx("svg",{className:`h-4 w-4 shrink-0 ${Y(n)?"text-flame":"text-taupe"}`,viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M7.22 4.22a.75.75 0 0 1 1.06 0l5.25 5.25a.75.75 0 0 1 0 1.06l-5.25 5.25a.75.75 0 1 1-1.06-1.06L11.94 10 7.22 5.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"})})]}):e.jsx(fe,{to:n.to,end:n.end,onClick:()=>g(null),className:({isActive:i})=>`nav-link ${i?"active":""}`,children:e.jsxs("span",{className:"flex items-center gap-2.5",children:[n.icon,e.jsx("span",{children:n.label})]})})},n.to))})}),e.jsx("div",{className:"border-t border-stone px-3 py-3",children:e.jsxs("button",{type:"button",onClick:a,className:"nav-link flex w-full items-center gap-2.5 text-left cursor-pointer",children:[Ae,e.jsx("span",{children:"Déconnexion"})]})})]}),e.jsxs("div",{className:`absolute inset-0 overflow-y-auto border-l border-stone/70 bg-white/60 px-4 py-4 transition-transform duration-300 ease-out ${X?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("button",{type:"button",onClick:()=>g(null),className:"btn-secondary-sm mb-3 cursor-pointer",children:[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})}),e.jsx("span",{children:"Retour"})]}),e.jsx("p",{className:"mb-3 text-[11px] font-medium uppercase tracking-[0.14em] text-flame",children:L?.label}),L?.to==="/questionnaires"?e.jsxs("nav",{children:[e.jsxs(N,{to:"/questionnaires#new",className:"btn-primary-sm mb-4 flex w-full cursor-pointer items-center justify-center gap-1.5",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"Nouveau projet"]}),e.jsx("ul",{className:"space-y-1",children:G?e.jsx("li",{children:e.jsx("span",{className:"subnav-link opacity-70",children:"Chargement..."})}):e.jsxs(e.Fragment,{children:[R.map(([n,i])=>{const u=M.has(n);return e.jsxs("li",{className:"pt-1",children:[e.jsxs("button",{type:"button",onClick:()=>Z(n),className:"flex w-full items-center gap-1.5 rounded-brand px-2 py-1.5 text-left text-xs font-semibold uppercase tracking-wide text-taupe transition-colors hover:bg-wash hover:text-ink",children:[e.jsx("svg",{className:`h-3 w-3 shrink-0 transition-transform ${u?"":"rotate-90"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.25,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),e.jsx("svg",{className:"h-3.5 w-3.5 shrink-0 text-taupe/80",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),e.jsx("span",{className:"truncate",children:n}),e.jsx("span",{className:"ml-auto text-[10px] font-normal tracking-normal text-taupe",children:i.length})]}),!u&&e.jsx("ul",{className:"ml-1 mt-1 space-y-1",children:i.map(c=>e.jsx("li",{children:e.jsx(N,{to:`/questionnaires#project/${c.id}`,className:`subnav-link ${D(c.id)?"active":""}`,children:c.name||"(Sans titre)"})},c.id))})]},n)}),R.length>0&&T.length>0&&e.jsxs("li",{className:"pt-1",children:[e.jsxs("button",{type:"button",onClick:()=>Z(B),className:"flex w-full items-center gap-1.5 rounded-brand px-2 py-1.5 text-left text-xs font-semibold uppercase tracking-wide text-taupe transition-colors hover:bg-wash hover:text-ink",children:[e.jsx("svg",{className:`h-3 w-3 shrink-0 transition-transform ${M.has(B)?"":"rotate-90"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.25,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),e.jsx("span",{className:"truncate",children:"Sans dossier"}),e.jsx("span",{className:"ml-auto text-[10px] font-normal tracking-normal text-taupe",children:T.length})]}),!M.has(B)&&e.jsx("ul",{className:"ml-1 mt-1 space-y-1",children:T.map(n=>e.jsx("li",{children:e.jsx(N,{to:`/questionnaires#project/${n.id}`,className:`subnav-link ${D(n.id)?"active":""}`,children:n.name||"(Sans titre)"})},n.id))})]}),R.length===0&&T.map(n=>e.jsx("li",{children:e.jsx(N,{to:`/questionnaires#project/${n.id}`,className:`subnav-link ${D(n.id)?"active":""}`,children:n.name||"(Sans titre)"})},n.id))]})}),!G&&f.length===0&&e.jsx("p",{className:"px-3 py-2 text-xs text-taupe",children:"Aucun projet"})]}):e.jsx("nav",{children:e.jsx("ul",{className:"space-y-1.5",children:L?.children?.map(n=>e.jsx("li",{children:e.jsx(N,{to:n.to,className:`subnav-link ${K(n)?"active":""}`,children:e.jsxs("span",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{children:n.label}),L?.to==="/modeles-documents"&&e.jsx("span",{className:`text-[10px] ${K(n)?"text-flame":"text-taupe"}`,children:de?"...":pe.get(n.to.split("/").pop()??"")??0})]})})},n.to))})})]})]})}),e.jsx("main",{className:r?"min-w-0 flex-1 min-h-0 overflow-hidden":"min-w-0 flex-1 min-h-0 overflow-y-auto px-6 py-10 md:px-8 md:py-12",children:t})]})]})}const Be=6e4;let A={token:null,byProject:new Map};function Oe(){return typeof window>"u"?null:window.localStorage.getItem("authToken")}function O(){const t=Oe();return A.token!==t&&(A={token:t,byProject:new Map}),A.byProject}function re(){A={token:null,byProject:new Map}}function lt(){const[t,a]=s.useState([]),[r,h]=s.useState(!1),[b,l]=s.useState(!1),p=s.useRef(null),j=s.useCallback(async o=>{p.current=o;const d=O(),f=d.get(o);if(f){if(a(f.responses),h(!1),Date.now()-f.fetchedAt<Be){l(!1);return}l(!0);try{const m=await q(o);p.current===o&&(a(m),d.set(o,{responses:m,fetchedAt:Date.now()}))}catch(m){console.error("Background refresh failed:",m)}finally{p.current===o&&l(!1)}}else{a([]),h(!0),l(!1);try{const m=await q(o);p.current===o&&(a(m),d.set(o,{responses:m,fetchedAt:Date.now()}))}catch(m){console.error("Load responses failed:",m),p.current===o&&a([])}finally{p.current===o&&h(!1)}}},[]),v=s.useCallback(async()=>{const o=p.current;if(o){l(!0);try{const d=await q(o);p.current===o&&(a(d),O().set(o,{responses:d,fetchedAt:Date.now()}))}catch(d){console.error("Refresh responses failed:",d)}finally{p.current===o&&l(!1)}}},[]),w=s.useCallback(o=>{O().delete(o)},[]),g=s.useCallback(()=>{p.current=null,a([]),h(!1),l(!1)},[]);return{responses:t,loading:r,backgroundRefreshing:b,loadResponses:j,refreshCurrent:v,invalidate:w,clear:g}}const $e=s.lazy(async()=>({default:(await k(()=>import("./DashboardPage-C0M8jXqd.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))).DashboardPage})),We=s.lazy(async()=>({default:(await k(()=>import("./AdministrationPage-BAZl-jYe.js"),__vite__mapDeps([8,1,2,3,5,6,7]))).AdministrationPage})),Ve=s.lazy(async()=>({default:(await k(()=>import("./BrandFontsPage-BI40ZGtU.js"),__vite__mapDeps([9,1,2]))).BrandFontsPage})),Ie=s.lazy(async()=>({default:(await k(()=>import("./BrandGuidelinesPage-BhgZi9DD.js"),__vite__mapDeps([10,1,2]))).BrandGuidelinesPage})),ze=s.lazy(async()=>({default:(await k(()=>import("./BrandSlidesPage-CXejh-6b.js"),__vite__mapDeps([11,1,2]))).BrandSlidesPage})),He=s.lazy(async()=>({default:(await k(()=>import("./DocumentTemplatesPage-Dukprxsm.js"),__vite__mapDeps([12,1,2,6,7,3]))).DocumentTemplatesPage})),Ge=s.lazy(async()=>({default:(await k(()=>import("./HomePage-C1icBYPW.js"),__vite__mapDeps([13,1,2]))).HomePage})),Ue=s.lazy(async()=>({default:(await k(()=>import("./LoginPage-CbGQ0pft.js"),__vite__mapDeps([14,1,2,3]))).LoginPage})),Qe=s.lazy(async()=>({default:(await k(()=>import("./WorkingMethodPage-CQGChQyM.js"),__vite__mapDeps([15,1,2]))).WorkingMethodPage}));function Ye(){return e.jsx("div",{className:"min-h-screen bg-cream flex items-center justify-center",children:e.jsx("div",{className:"inline-block w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})})}function Ke(){return e.jsx("div",{className:"flex items-center justify-center h-full py-24",children:e.jsx("div",{className:"inline-block w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})})}function Xe(){const t=le(),[a,r]=s.useState(()=>ke()),[h,b]=s.useState("idle"),l=!!a,p=a?.user.role==="admin",j=a?.token??null;s.useEffect(()=>{l&&(ce().catch(o=>{console.error("Preload projects failed:",o)}),ie().catch(o=>{console.error("Preload document templates failed:",o)}))},[l]),s.useEffect(()=>{if(!j)return;let o=!1;return ve().then(d=>{o||r(f=>{if(!f||f.token!==j)return f;const m={token:f.token,user:d};return J(m),m})}).catch(d=>{o||(console.error("Session refresh failed:",d),oe(),ne(),re(),ee(),r(null))}),()=>{o=!0}},[j]);const v=o=>{J(o),r(o)},w=()=>{oe(),ne(),re(),ee(),r(null)};if(!l)return e.jsx(s.Suspense,{fallback:e.jsx(Ye,{}),children:e.jsx(Ue,{onLogin:v,title:"Connexion requise",subtitle:"Connectez-vous pour accéder à l'espace Team."})});const g=t.pathname==="/questionnaires";return e.jsx(qe,{onLogout:w,fullBleed:g,headerSyncState:g?h:void 0,canAccessAdministration:p,children:e.jsx(s.Suspense,{fallback:e.jsx(Ke,{}),children:e.jsxs(xe,{children:[e.jsx(x,{path:"/",element:e.jsx(Ge,{})}),e.jsx(x,{path:"/notre-facon-de-travailler",element:e.jsx(Qe,{})}),e.jsx(x,{path:"/charte-graphique",element:e.jsx(Ie,{})}),e.jsx(x,{path:"/charte-graphique/slides",element:e.jsx(ze,{})}),e.jsx(x,{path:"/charte-graphique/fonts",element:e.jsx(Ve,{})}),e.jsx(x,{path:"/modeles-documents",element:e.jsx(F,{to:"/modeles-documents/preparation",replace:!0})}),e.jsx(x,{path:"/modeles-documents/:phase",element:e.jsx(He,{})}),e.jsx(x,{path:"/questionnaires",element:e.jsx($e,{onSyncStateChange:b})}),e.jsx(x,{path:"/administration",element:p?e.jsx(We,{}):e.jsx(F,{to:"/",replace:!0})}),e.jsx(x,{path:"*",element:e.jsx(F,{to:"/",replace:!0})})]})})})}const it=Object.freeze(Object.defineProperty({__proto__:null,default:Xe},Symbol.toStringTag,{value:"Module"}));export{it as A,nt as D,te as a,we as b,ie as c,st as d,ce as e,at as f,se as g,ot as h,rt as s,lt as u};
